<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>建設業経理士1級 問題集</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <button id="dark-mode-btn" class="dark-mode-btn" onclick="toggleDarkMode()" title="ダークモード">&#127769;</button>

        <!-- スタート画面 -->
        <div id="start-screen" class="screen active">
            <div class="header">
                <h1>建設業経理士1級</h1>
                <h2>過去問題集</h2>
                <p class="year">原価計算（計算）</p>
            </div>

            <div class="stats-summary">
                <div class="stats-item">
                    <span class="stats-label">学習進捗</span>
                    <span id="progress-percentage" class="stats-value" style="color: var(--secondary-color);">0%</span>
                </div>
                <div class="stats-item">
                    <span class="stats-label">連続学習</span>
                    <span id="streak-count" class="stats-value" style="color: var(--warning-color);">0日</span>
                </div>
                <div class="stats-item">
                    <span class="stats-label">学習済み</span>
                    <span id="studied-count" class="stats-value">0問</span>
                </div>
                <div class="stats-item">
                    <span class="stats-label">総問題数</span>
                    <span id="total-questions" class="stats-value">0問</span>
                </div>
                <div class="stats-item clickable" onclick="showStatsScreen()">
                    <span class="stats-label">詳細を見る</span>
                    <span class="stats-value">&#128202;</span>
                </div>
            </div>

            <div class="exam-info">
                <div class="info-card">
                    <h3>試験概要</h3>
                    <ul>
                        <li><strong>出題範囲:</strong> 原価計算（計算）</li>
                        <li><strong>出題形式:</strong> 記述式・計算問題</li>
                        <li><strong>学習方法:</strong> 問題を見て解答を考え、「解答を表示」で確認</li>
                    </ul>
                    <p style="font-size: 0.85rem; color: var(--text-light); margin-top: 10px;">
                        ※本アプリはソースPDFから抽出した過去問題です
                    </p>
                </div>
            </div>

            <div class="session-filter">
                <h3>試験回を選択</h3>
                <div id="session-buttons" class="session-buttons">
                    <!-- 動的に生成 -->
                </div>
            </div>

            <div class="mode-selection">
                <h3>学習モードを選択</h3>
                <button class="btn btn-primary" onclick="startStudy('all')">
                    <span class="btn-icon">&#128221;</span>全問題
                </button>
                <button class="btn btn-accent" onclick="startStudy('random')">
                    <span class="btn-icon">&#127922;</span>ランダム20問
                </button>
                <button class="btn btn-secondary" onclick="startUnstudied()">
                    <span class="btn-icon">&#128218;</span>未学習のみ
                </button>
                <button class="btn btn-warning" onclick="startStudy('bookmarked')">
                    <span class="btn-icon">&#11088;</span>ブックマーク
                </button>
            </div>

            <div class="keyboard-hints" style="background: var(--card-bg); border-radius: 12px; padding: 16px; margin-top: 20px; box-shadow: var(--shadow);">
                <h4 style="color: var(--text-light); font-size: 0.9rem; margin-bottom: 10px;">キーボードショートカット</h4>
                <div style="display: flex; flex-wrap: wrap; gap: 8px; font-size: 0.8rem; color: var(--text-light);">
                    <span><kbd style="background: var(--bg-color); padding: 2px 6px; border-radius: 4px;">Space</kbd> 解答表示</span>
                    <span><kbd style="background: var(--bg-color); padding: 2px 6px; border-radius: 4px;">&#8594;</kbd> わかった</span>
                    <span><kbd style="background: var(--bg-color); padding: 2px 6px; border-radius: 4px;">&#8592;</kbd> 難しい</span>
                    <span><kbd style="background: var(--bg-color); padding: 2px 6px; border-radius: 4px;">B</kbd> ブックマーク</span>
                </div>
            </div>

            <div class="back-link">
                <a href="../index.html">&#8592; トップページに戻る</a>
            </div>
        </div>

        <!-- 学習画面 -->
        <div id="study-screen" class="screen">
            <div class="study-header">
                <div class="study-header-top">
                    <button class="home-btn" onclick="goHome()" title="トップに戻る">&#10005;</button>
                    <div class="session-badge" id="session-badge">第23回</div>
                    <button id="bookmark-btn" class="bookmark-btn" onclick="toggleBookmarkCurrent()" title="ブックマーク">&#9734;</button>
                </div>
                <div class="progress-info">
                    <span id="current-num">1</span> / <span id="total-num">30</span>
                </div>
                <div class="progress-bar">
                    <div id="progress" class="progress-fill"></div>
                </div>
            </div>

            <div class="question-card">
                <div class="question-header">
                    <span class="question-type" id="question-type">第1問</span>
                    <span class="question-number">問<span id="question-no">1</span></span>
                </div>
                <div id="question-text" class="question-text"></div>
                <div id="question-data" class="question-data"></div>
                <div id="choices-container" class="choices hidden"></div>
            </div>

            <div id="quiz-feedback" class="feedback hidden"></div>

            <div id="answer-section" class="answer-section hidden">
                <div class="answer-header">&#128161; 解答・解説</div>
                <div id="answer-text" class="answer-text"></div>
            </div>

            <div class="study-controls">
                <button id="show-answer-btn" class="btn btn-primary" onclick="showAnswer()">
                    <span class="btn-icon">&#128065;</span>解答を表示
                </button>
                <div id="next-controls" class="next-controls hidden">
                    <button id="flashcard-controls-difficult" class="btn btn-secondary" onclick="markDifficult()">
                        <span class="btn-icon">&#128534;</span>難しい
                    </button>
                    <button id="flashcard-controls-easy" class="btn btn-success" onclick="markEasy()">
                        <span class="btn-icon">&#128077;</span>わかった
                    </button>
                    <button id="quiz-next-btn" class="btn btn-primary hidden" onclick="nextQuestion()">
                        <span class="btn-icon">&#8594;</span>次の問題
                    </button>
                </div>
            </div>
        </div>

        <!-- 完了画面 -->
        <div id="complete-screen" class="screen">
            <div class="complete-header">
                <h2>学習完了</h2>
            </div>
            <div class="complete-card">
                <div class="complete-icon">&#127881;</div>
                <div class="complete-stats">
                    <p>学習問題数: <span id="complete-total">0</span>問</p>
                    <p>わかった: <span id="complete-easy">0</span>問</p>
                    <p>難しい: <span id="complete-difficult">0</span>問</p>
                </div>
            </div>
            <div class="complete-actions">
                <button class="btn btn-warning" onclick="reviewDifficult()">
                    <span class="btn-icon">&#128260;</span>難しい問題を復習
                </button>
                <button class="btn btn-accent" onclick="goHome()">
                    <span class="btn-icon">&#127968;</span>スタートに戻る
                </button>
                <a href="../index.html" class="btn btn-secondary" style="text-decoration: none; display: inline-flex; align-items: center; justify-content: center;">
                    <span class="btn-icon">&#127760;</span>サイトトップへ
                </a>
            </div>
        </div>

        <!-- 統計画面 -->
        <div id="stats-screen" class="screen">
            <div class="stats-header">
                <h2>学習統計</h2>
                <button class="btn btn-small" onclick="goHome()">&#8592; 戻る</button>
            </div>
            <div class="stats-cards">
                <div class="stats-card">
                    <h3>全体統計</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="stat-label">総問題数</span>
                            <span id="stats-total" class="stat-value">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">学習済み</span>
                            <span id="stats-studied" class="stat-value">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">わかった</span>
                            <span id="stats-easy" class="stat-value">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">難しい</span>
                            <span id="stats-difficult" class="stat-value">0</span>
                        </div>
                    </div>
                </div>
                <div class="stats-card">
                    <h3>分野別進捗</h3>
                    <div id="category-progress" class="category-progress"></div>
                </div>
                <div class="stats-card">
                    <h3>ブックマーク</h3>
                    <div id="bookmark-list" class="bookmark-list"></div>
                </div>
                <div class="stats-card danger-zone">
                    <h3>データ管理</h3>
                    <p class="danger-text">学習データをリセットすると、進捗・ブックマークが全て削除されます。</p>
                    <button class="btn btn-danger" onclick="resetAllData()">
                        <span class="btn-icon">&#128465;</span>データをリセット
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="../user-manager.js"></script>
    <script src="questions.js"></script>
    <script src="app.js"></script>
</body>
</html>
